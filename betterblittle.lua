local a=math.floor;local b=table.concat;local c={}for d=1,16 do c[2^(d-1)]=("0123456789abcdef"):sub(d,d)end;local function e(f,g,h,i,j,k)local l={}l[f]=1;l[g]=(l[g]or 0)+1;l[h]=(l[h]or 0)+1;l[i]=(l[i]or 0)+1;l[j]=(l[j]or 0)+1;l[k]=(l[k]or 0)+1;local m=f;local n=0;local o=f;local p=0;for q,r in pairs(l)do if r>p then if r>n then o=m;p=n;m=q;n=r else o=q;p=r end end end;return m,o end;local s={[0]={8,4,3,6,5},{4,14,8,7},{6,10,8,7},{9,11,8,0},{1,14,8,0},{13,12,8,0},{2,10,8,0},{15,8,10,11,12,14},{0,7,1,9,2,13},{3,11,8,7},{2,6,7,15},{9,3,7,15},{13,5,7,15},{5,12,8,7},{1,4,7,15},{7,10,11,12,14}}local t={}for d=0,15 do local u=s[d]for d=1,#u do u[d]=math.pow(2,u[d])end;t[math.pow(2,d)]=u end;local function v(w,x,y)local u=t[w]for d=1,#u do if u[d]==x then return true elseif u[d]==y then return false end end;return false end;local z=string.char;local A={}for d=128,128+31 do A[d]=z(d)end;local B=bit.bxor;local function C(x,y,f,g,h,i,j,k)local D=v;local E=128;if f==x or f~=y and D(f,x,y)then E=E+1 end;if g==x or g~=y and D(g,x,y)then E=E+2 end;if h==x or h~=y and D(h,x,y)then E=E+4 end;if i==x or i~=y and D(i,x,y)then E=E+8 end;if j==x or j~=y and D(j,x,y)then E=E+16 end;if k==x or k~=y and D(k,x,y)then return A[B(31,E)],true end;return A[E],false end;local function F(G,H)local I=#G;local J=#G[1]local K=a(J/2)local L=H.setCursorPos;local M=H.blit;local c=c;for N=1,a(I/3)do local O=(N-1)*3+1;local P=G[O]local Q=G[O+1]local R=G[O+2]local S={nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil}local T={nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil}local U={nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil}for V=1,K do local W=(V-1)*2+1;local f=P[W]local g=P[W+1]local h=Q[W]local i=Q[W+1]local j=R[W]local k=R[W+1]if f==g and g==h and h==i and i==j and j==k then local X=c[f]S[V]=X;T[V]=X;U[V]="\x80"else local x,y=e(f,g,h,i,j,k)local z,Y=C(x,y,f,g,h,i,j,k)if Y then local Z=c[y]local _=c[x]S[V]=Z;T[V]=_ else local Z=c[y]local _=c[x]S[V]=_;T[V]=Z end;U[V]=z end end;local a0=b;local x=a0(U)local y=a0(S)local a1=a0(T)L(1,N)M(x,y,a1)end end;return{drawBuffer=F}