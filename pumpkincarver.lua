local a=math.pi;local b=math.cos;local c=math.sin;local d=math.sqrt;local e=require("PineWorks")local f=e.scene.new()print("Getting ready. This can take a few seconds...")local g,h=term.getSize()local i={controlBar=f.hud:addWindow(1,h,g,1),subMenu=f.hud:addWindow(1,h+1,1,1)}local j={"Save","Load","New","Showcase","Hide","Exit"}local k=1;local l=1;local m=false;local n=false;local o=false;local p=""local q=math.pi*0.5;local r=math.pi*0.5;local s=1.5;local t=7;local u=3;local v=math.pi;local w=math.pi;local x=math.pi*1.125;local y=math.pi*0.5;local z=250;local A=_HOST and _HOST:find("luajit")and true or false;if A then e.log("Running LuaJIT")z=50 else e.log("Running normal Lua")end;local B=0;local C=false;local D={colors.red,colors.orange,colors.yellow,colors.lime,colors.green,colors.cyan,colors.blue}local function E(F)local G=math.floor(math.max(0,math.min(0.9999,F))*#D)+1;return D[G]end;local function H(I)for G=1,#I do local J=I[G]e.setPaletteColor(D[G],J[1]/255,J[2]/255,J[3]/255)end end;local K={{91,18,3},{148,49,7},{189,66,7},{225,105,10},{231,146,42},{237,187,74},{252,213,174}}local L=0.4;local M=0.6;local N=0.7;local O={{91*L,18*M,3*N},{148*L,49*M,7*N},{189*L,66*M,7*N},{225*L,105*M,10*N},{231*L,146*M,42*N},{237*L,187*M,74*N},{252*L,213*M,174*N}}local P={sky=colors.purple,clouds=colors.lightGray,foliage=colors.magenta,foliageDark=colors.pink,treeBark=colors.lightBlue,tableTop=colors.gray,uiAccent=colors.lightGray}local Q={skyDay={175/255,170/255,224/255},skyNight={17/255,0/255,47/255},cloudsDay={206/255,206/255,225/255},cloudsNight={96/255,96/255,170/255},foliageDarkNight={8/255,54/255,73/255},foliageDarkDay={103/255,107/255,29/255},foliageDay={121/255,160/255,20/255},foliageNight={22/255,81/255,70/255},treeBarkDay={91/255,62/255,33/255},treeBarkNight={30/255,29/255,26/255},tableTopDay={211/255,135/255,91/255},tableTopNight={61/255,45/255,21/255}}e.frame:setBackgroundColor(P.sky)local function R()if C then H(O)e.setPaletteColor(P.sky,Q.skyNight)e.setPaletteColor(P.clouds,Q.cloudsNight)e.setPaletteColor(P.foliageDark,Q.foliageDarkNight)e.setPaletteColor(P.foliage,Q.foliageNight)e.setPaletteColor(P.treeBark,Q.treeBarkNight)e.setPaletteColor(P.tableTop,Q.tableTopNight)else H(K)e.setPaletteColor(P.sky,Q.skyDay)e.setPaletteColor(P.clouds,Q.cloudsDay)e.setPaletteColor(P.foliageDark,Q.foliageDarkDay)e.setPaletteColor(P.foliage,Q.foliageDay)e.setPaletteColor(P.treeBark,Q.treeBarkDay)e.setPaletteColor(P.tableTop,Q.tableTopDay)end end;R()local function S()local T={}local U=7;local V=20;local W=math.random(5,9)if not A then W=math.random(5,7)V=15 end;local X=math.random()+1;local Y={}for G=0,V do local Z=G/V;local _=X*(Z-0.5)^2+1;Y[G]=_ end;for G=1,W do local a0=G%2==0 and colors.orange or colors.red;local a1=math.random()*1.5+0.1;for a2=1,V do local a3=0.5*b((a2-1)/V*a)local a4=0.5*b(a2/V*a)local a5=0.5*d(1-a3*2*a3*2)*Y[a2-1]local a6=0.5*d(1-a4*2*a4*2)*Y[a2]local function a7(Z,a8)local a9=1-math.min(a8,1-a8)^3*a1;local aa=b(Z/W*a*2)*a9;local ab=c(Z/W*a*2)*a9;return aa,ab end;local ac=U-1;for ad=1,ac do local a8=(ad-1)/ac;local ae,af=a7(G+a8,a8)local ag,ah=a7(G+a8+1/ac,a8+1/ac)local ai=(1-math.abs(a3)*2)^1;local aj=0.25+2*-math.abs(a8+0.5/ac-0.5)^2*ai;local ak=(a3+0.5)^0.25-1;local F=0.5+aj+ak;local al=E(F+math.random()*0.1)local am=E(F+math.random()*0.1)T[#T+1]={x1=ae*a5,y1=a3,z1=af*a5,x2=ag*a6,y2=a4,z2=ah*a6,x3=ae*a6,y3=a4,z3=af*a6,c=al}T[#T+1]={x1=ag*a6,y1=a4,z1=ah*a6,x2=ae*a5,y2=a3,z2=af*a5,x3=ag*a5,y3=a3,z3=ah*a5,c=am}end end end;local an=(math.random()-0.5)*0.5;local ao=(math.random()-0.5)*0.5;local ap=(math.random()-0.5)*0.5;local aq=0.5;local ar=0.5;local function as(aa,at,ab)local au=an-aa;local av=ao-at;local aw=ap-ab;local ax=aq^au*ar;local ay=aq^av*ar;local az=aq^aw*ar;return aa+ax,at+ay,ab+az end;for G=1,#T do local aA=T[G]aA.x1,aA.y1,aA.z1=as(aA.x1,aA.y1,aA.z1)aA.x2,aA.y2,aA.z2=as(aA.x2,aA.y2,aA.z2)aA.x3,aA.y3,aA.z3=as(aA.x3,aA.y3,aA.z3)end;T=e.Pine3D.transforms.center(T)T=e.Pine3D.transforms.normalizeScale(T)T=e.Pine3D.transforms.alignBottom(T)local aB=1;for G=1,#T do local aA=T[G]local aC={}for ad,aD in pairs(aA)do aC[ad]=aD end;aC.x1=aA.x1*aB;aC.y1=aA.y1*aB;aC.z1=aA.z1*aB;aC.x2=aA.x3*aB;aC.y2=aA.y3*aB;aC.z2=aA.z3*aB;aC.x3=aA.x2*aB;aC.y3=aA.y2*aB;aC.z3=aA.z2*aB;aC.c=colors.brown;T[#T+1]=aC end;return T end;local aE=f:add(S(),0,0,0)local aF=e.model("models/skybox3.stab"):invertTriangles():center():translate(nil,0.3):rotate(nil,-math.pi*0.5,nil):scale(1)aF:mapColor({[colors.green]=P.foliageDark,[colors.lime]=P.foliage})local aG=f:addEnv(aF)local aH=f:addEnv(e.model("models/clouds.stab",{skipNormalize=true}):invertTriangles():scale(2):mapColor({[colors.white]=P.clouds}))local aI=e.model("models/table.stab"):invertTriangles():center():scale(2.5):invertTriangles():mapColor({[colors.white]=P.tableTop})local aJ=f:add(aI,0,-1.25,0)local function aK()local aL=os.epoch("utc")local T=aE.pineObject[7]for G=1,#T do local aA=T[G]if aA[13]then return end;aA[13]=G end;local aM=math.abs;local aN=0.01;local function aO(aP,aQ)local aR=0;for G=0,2 do for a2=0,2 do local aS=aM(aP[G*3+1]-aQ[a2*3+1])local aT=aM(aP[G*3+2]-aQ[a2*3+2])local aU=aM(aP[G*3+3]-aQ[a2*3+3])if aS+aT+aU<=aN then aR=aR+1;break end end;if G==2 and aR==0 then return false end end;return aR>=2 end;local aV=0.45^2;if not A then aV=0.55^2 end;for G=1,#T do local aW=T[G]if aW[11]==colors.brown then aW[14]={}else local aX={}for a2=1,#T do local aY=T[a2]if G~=a2 then local aS=aW[1]-aY[1]local aT=aW[2]-aY[2]local aU=aW[3]-aY[3]local aZ=aS*aS+aT*aT+aU*aU;if aZ<aV then if aO(aW,aY)then aX[#aX+1]=a2 end end end end;aW[14]=aX end end;local a_=os.epoch("utc")e.log("Init connections took "..a_-aL.." ms")end;aK()aH:on("update",function(b0)local b1=B*math.pi*2*0.003;b1=b1+math.sin(B*0.2)*math.pi*0.015;aH:setPos(nil,nil,nil,nil,b1)end)local b2=math.pi*0.02;local b3=1.61803398875;local b4=50;if not A then b4=25 end;for G=10,9+b4 do local Z=G*b3*math.pi*2;local b5=G*1;local aa=math.sin(Z)*b5;local ab=math.cos(Z)*b5;local b6=math.random()*0.5+1;local b7=e.model("models/pinetree2.stab"):alignBottom():scale(10*b6):rotate(nil,math.random()*math.pi*2)b7:mapColor({[colors.green]=P.foliageDark,[colors.lime]=P.foliage,[colors.brown]=P.treeBark})local b8=f:add(b7,aa,-2.5,ab)b8:on("update",function(b0)local b9=math.sin(B*0.5+aa*0.2)*b2;local ba=math.cos(B*0.2+ab*0.2)*b2;b8:setPos(nil,nil,nil,b9,nil,ba)end)end;local bb=os.clock()if not fs.exists("pumpkins")then fs.makeDir("pumpkins")end;local bc={}local bd=1;local function be()local bf=fs.list("pumpkins")bc={}bd=1;for G=1,#bf do local bg=bf[G]if bg:sub(-5,-1)==".stab"then local bh=bg:sub(1,-6)bc[#bc+1]=bh;bd=math.max(bd,#bh)end end end;be()local function bi(T,aa,at,ab,bj)if#T<=0 then return end;if#T>1 then if math.random(1,2)==1 then e.audio.playSound("block.wood.hit")else e.audio.playSound("block.wood.break")end else if math.random(1,2)==1 then e.audio.playSound("block.stem.break",0.2)else e.audio.playSound("block.shroomlight.hit",0.2)end end;bj=bj or 1;local bk=(math.random()-0.5)*4*bj;local bl=(math.random()-0.5)*4*bj;local bm=(math.random()-0.5)*4*bj;local bn=f:add(T,aa,at,ab)local bo=B;local bp=aa;local bq=at;local br=ab;bn:on("update",function(b0)local bs=B-bo;bq=bq-7*b0;local aS=bp*b0;local aT=bq*b0;local aU=br*b0;local bt=bn.x+aS;local bu=bn.y+aT;local bv=bn.z+aU;bn:setPos(bt,bu,bv,bs*math.pi*bk,bs*math.pi*bl,bs*math.pi*bm)if bs>1 then bn:remove()end end)end;local function bw(aA)if aA[11]==colors.brown then return end;local ae=aA[1]local a3=aA[2]local af=aA[3]local ag=aA[4]local a4=aA[5]local ah=aA[6]local bx=aA[7]local by=aA[8]local bz=aA[9]local T={{x1=ae-ae,y1=a3-a3,z1=af-af,x2=ag-ae,y2=a4-a3,z2=ah-af,x3=bx-ae,y3=by-a3,z3=bz-af,c=aA[11],forceRender=true}}bi(T,ae,a3,af)end;local bA=0;local bB=true;local function bC()local T=aE.pineObject[7]local bD={}for G=1,#T do local aA=T[G]local bE=aA[13]bD[bE]=G end;local bF={}local bG={}local bH=0;local bI={1}local aL=os.epoch("utc")while#bI>0 do local G=table.remove(bI,1)bF[G]=true;bH=bH+1;local aA=T[G]local bJ=aA[14]for a2=1,#bJ do local bE=bJ[a2]local bK=bD[bE]if bK and not bF[bK]and not bG[bK]then bI[#bI+1]=bK;bG[bK]=true end end end;e.log("Visited: "..bH.." / "..#T)local a_=os.epoch("utc")e.log("broken check took "..a_-aL.." ms")if bH>#T*0.5 then local bL={}local bM=0;local bN=0;local bO=0;for a2=#T,1,-1 do if not bF[a2]then local aA=T[a2]if aA[11]~=colors.brown then bM=bM+aA[1]bN=bN+aA[2]bO=bO+aA[3]bL[#bL+1]={x1=aA[1],y1=aA[2],z1=aA[3],x2=aA[4],y2=aA[5],z2=aA[6],x3=aA[7],y3=aA[8],z3=aA[9],c=aA[11],forceRender=true}end;table.remove(T,a2)end end;local bP=bM/#bL;local bQ=bN/#bL;local bR=bO/#bL;for G=1,#bL do local aA=bL[G]aA.x1=aA.x1-bP;aA.y1=aA.y1-bQ;aA.z1=aA.z1-bR;aA.x2=aA.x2-bP;aA.y2=aA.y2-bQ;aA.z2=aA.z2-bR;aA.x3=aA.x3-bP;aA.y3=aA.y3-bQ;aA.z3=aA.z3-bR end;bi(bL,bP,bQ,bR,0.5)else local bL={}local bM=0;local bN=0;local bO=0;for a2=#T,1,-1 do if bF[a2]then local aA=T[a2]if aA[11]~=colors.brown then bM=bM+aA[1]bN=bN+aA[2]bO=bO+aA[3]bL[#bL+1]={x1=aA[1],y1=aA[2],z1=aA[3],x2=aA[4],y2=aA[5],z2=aA[6],x3=aA[7],y3=aA[8],z3=aA[9],c=aA[11],forceRender=true}end;table.remove(T,a2)end end;local bP=bM/#bL;local bQ=bN/#bL;local bR=bO/#bL;for G=1,#bL do local aA=bL[G]aA.x1=aA.x1-bP;aA.y1=aA.y1-bQ;aA.z1=aA.z1-bR;aA.x2=aA.x2-bP;aA.y2=aA.y2-bQ;aA.z2=aA.z2-bR;aA.x3=aA.x3-bP;aA.y3=aA.y3-bQ;aA.z3=aA.z3-bR end;bi(bL,bP,bQ,bR,0.5)bC()end;local bS=os.epoch("utc")e.log("spawning particle mesh took "..bS-a_.." ms")end;f:on("update",function(b0)B=B+b0;local bT=os.epoch("utc")if not bB and bT>bA+z then bC()bB=true end;if not m then local bU=f.camera;local bV=e.isDown;if bV[keys.a]or bV[keys.left]then w=w+q*b0 end;if bV[keys.d]or bV[keys.right]then w=w-q*b0 end;if bV[keys.w]or bV[keys.up]then v=v-r*b0 elseif bV[keys.s]or bV[keys.down]then v=v+r*b0 end;v=math.min(x,math.max(y,v))local at=math.sin(v)*u+1;local bW=math.cos(v)*u;local aa=math.cos(w)*bW;local ab=math.sin(w)*bW;bU:setPos(aa,at,ab,nil,math.deg(w),math.deg(v)+180)end;if C then local bX=os.clock()if bX>bb+0.1 then bb=bX;local Z=130;local bY=60;local bZ=0;local _=math.random()*0.5+1.5;Z=math.min(255,Z*_)bY=math.min(255,bY*_)bZ=math.min(255,bZ*_)e.setPaletteColor(colors.brown,Z/255,bY/255,bZ/255)end else e.setPaletteColor(colors.brown,107/255,29/255,11/255)end;local b_=i.controlBar.win;b_.setBackgroundColor(colors.black)b_.clear()b_.setCursorPos(1,1)local g,h=term.getSize()if m then b_.reposition(1,h,g,1)for G=1,#j do local c0=j[G]if k==G then b_.setTextColor(P.uiAccent)b_.write("[")b_.setTextColor(colors.white)b_.write(c0)b_.setTextColor(P.uiAccent)b_.write("]")else b_.setTextColor(colors.white)b_.write(" "..c0 .." ")end end elseif not n then b_.setTextColor(P.uiAccent)local c1="Press Ctrl to access menu"b_.write(c1)b_.reposition(1,h,#c1,1)else b_.reposition(1,h+1,1,1)end;local c2=i.subMenu.win;if m and o then local c0=j[k]local c3=0;for G=1,#j do local c4=j[G]if c4==c0 then break end;c3=c3+#c4+2 end;if c0=="Save"then local c5="Name: "..p;c2.reposition(1+c3,h-1,math.max(20,#c5+1),1)c2.setBackgroundColor(colors.black)c2.clear()c2.setTextColor(colors.white)c2.setCursorPos(1,1)c2.write(c5)else c2.reposition(1+c3,h-#bc,bd+1,#bc)c2.setBackgroundColor(colors.black)c2.clear()for G=1,#bc do local bh=bc[G]if l==G then c2.setCursorPos(1,G)c2.setTextColor(P.uiAccent)c2.write(">")c2.setTextColor(colors.white)c2.write(bh)else c2.setTextColor(colors.white)c2.setCursorPos(1,G)c2.write(" "..bh)end end end else c2.reposition(1,h+1,1,1)end end)local c6={x=nil,y=nil}local function c7(aa,at,c8)local c9,ca=e.frame:getObjectIndexTrace({aE.pineObject},aa,at)if c9 then local T=aE.pineObject[7]local cb=T[ca]if cb[11]==colors.brown then return end;local cc=(cb[1]+cb[4]+cb[7])/3;local cd=(cb[2]+cb[5]+cb[8])/3;local ce=(cb[3]+cb[6]+cb[9])/3;local cf=c8*c8;for G=#T,1,-1 do local aA=T[G]local aa=(aA[1]+aA[4]+aA[7])/3;local at=(aA[2]+aA[5]+aA[8])/3;local ab=(aA[3]+aA[6]+aA[9])/3;local aS=cc-aa;local aT=cd-at;local aU=ce-ab;local aZ=aS*aS+aT*aT+aU*aU;if aZ<cf then bw(aA)table.remove(T,G)end end;bA=os.epoch("utc")bB=false;local T=aE.pineObject[7]if#T==0 then error("WHY WOULD YOU DO THAT??? WHY WOULD YOU REMOVE THE ENTIRE PUMPKIN??? How can you even call this a carving smh...")end end end;f:on("mouse_drag",function(cg,aa,at)if cg==1 then if C then return end;c7(aa,at,0.01)if c6.x and c6.y and A then local aS=aa-c6.x;local aT=at-c6.y;local ch=(math.abs(aS)+math.abs(aT))*2;for G=1,ch do local _=(G-1)/ch;local ci=c6.x+aS*_;local cj=c6.y+aT*_;c7(ci,cj,0.05)end end elseif cg==2 then if c6.x and c6.y then local aS=aa-c6.x;local aT=at-c6.y;aS=aS/g;aT=aT/h;local _=2;w=w+q*aS*_;v=v-r*aT*_;v=math.min(x,math.max(y,v))local at=math.sin(v)*u+1;local bW=math.cos(v)*u;local aa=math.cos(w)*bW;local ab=math.sin(w)*bW;local bU=f.camera;bU:setPos(aa,at,ab,nil,math.deg(w),math.deg(v)+180)end end;c6.x=aa;c6.y=at end)f:on("mouse_up",function(cg,aa,at)c6.x=nil;c6.y=nil end)f:on("mouse_click",function(cg,aa,at)c6.x=aa;c6.y=at;if cg==1 then if C then return end;c7(aa,at,0.01)end end)local function ck(cl)local T={}for G=1,#cl do local cm=cl[G]T[G]={x1=cm[1],y1=cm[2],z1=cm[3],x2=cm[4],y2=cm[5],z2=cm[6],x3=cm[7],y3=cm[8],z3=cm[9],forceRender=cm[10],c=cm[11],outlineColor=cm[12]}end;local cn=textutils.serialise(T)return cn end;local function co(cl,cp)local cq={}local cr=1;local function cs(aa,at,ab)local ct=aa..","..at..","..ab;if cq[ct]then return cq[ct]end;local cu={nr=cr,x=aa,y=at,z=ab}cr=cr+1;cq[ct]=cu;return cu end;local cv={}local cw=1;local function cx(cy)if cv[cy]then return cv[cy]end;local cz="unknown"for bh,a0 in pairs(colors)do if cy==a0 then cz=bh;break end end;local cA={nr=cw,color=cy,colorName=cz}cw=cw+1;cv[cy]=cA;return cA end;local cB={}for G=1,#cl do local cm=cl[G]local cC=cs(cm[1],cm[2],cm[3])local cD=cs(cm[4],cm[5],cm[6])local cE=cs(cm[7],cm[8],cm[9])local cA=cx(cm[11])cB[G]={v={cC,cD,cE},mat=cA}end;local function cF(cC,cD,cE)local cG=cD.x-cC.x;local cH=cD.y-cC.y;local cI=cD.z-cC.z;local cJ=cE.x-cC.x;local cK=cE.y-cC.y;local cL=cE.z-cC.z;local cM=cH*cL-cI*cK;local cN=cI*cJ-cG*cL;local cO=cG*cK-cH*cJ;local cP=math.sqrt(cM*cM+cN*cN+cO*cO)if cP==0 then return end;return cM/cP,cN/cP,cO/cP end;local cQ="# exported from Pumpkin Carver\nmtllib "..cp..".mtl\n\n"local cR=""local cS={}for ct,cu in pairs(cq)do cS[cu.nr]=cu end;for G=1,#cS do local cu=cS[G]cQ=cQ.."v "..cu.x.." "..cu.y.." "..cu.z.."\n"end;table.sort(cB,function(cT,bZ)return cT.mat.color>bZ.mat.color end)cQ=cQ.."\n"local cU=""local cV=nil;for ct,cW in pairs(cB)do if cV~=cW.mat then cU=cU.."usemtl mat"..cW.mat.nr.."_"..cW.mat.colorName.."\n"cV=cW.mat end;local cX=cW.v;local cY,cZ,c_=cF(cX[1],cX[2],cX[3])cY=cY or 0;cZ=cZ or 0;c_=c_ or 0;cR=cR.."vn "..cY.." "..cZ.." "..c_.."\n"cU=cU.."f "..cX[1].nr.."//"..ct.." "..cX[2].nr.."//"..ct.." "..cX[3].nr.."//"..ct.."\n"end;cQ=cQ..cR;cQ=cQ.."\n"cQ=cQ..cU;local d0="# exported from Pumpkin Carver\n\n"local function d1(d2)local a0=0;if d2<=0.04045 then a0=d2/12.92 else a0=math.pow((d2+0.055)/1.055,2.4)end;return a0 end;for d3,cA in pairs(cv)do local Z,bY,bZ=term.getPaletteColor(cA.color)Z=d1(Z)bY=d1(bY)bZ=d1(bZ)d0=d0 .."newmtl mat"..cA.nr.."_"..cA.colorName.."\nKd "..Z.." "..bY.." "..bZ.."\n\n"end;return cQ,d0 end;local function d4(bh)local cl=aE.pineObject[7]local cp="pumpkins/"..bh;local d5={}for G=1,#cl do local d6=cl[G]local _=d6[11]==colors.brown and 0.99 or 1;d5[G]={d6[1]*_,d6[2]*_,d6[3]*_,d6[4]*_,d6[5]*_,d6[6]*_,d6[7]*_,d6[8]*_,d6[9]*_,d6[10],d6[11],d6[12]}end;local aL=os.epoch("utc")local d7=ck(cl)local a_=os.epoch("utc")local cQ,d0=co(d5,cp)local bS=os.epoch("utc")e.log("encoding P3D took "..a_-aL.."ms")e.log("encoding .obj took "..bS-a_.."ms")local bg=cp..".stab"local d8=fs.open(bg,"w")d8.write(d7)d8.close()e.log("Saved to "..bg.."!")local bg=cp..".obj"local d8=fs.open(bg,"w")d8.write(cQ)d8.close()e.log("Saved to "..bg.."!")local bg=cp..".mtl"local d8=fs.open(bg,"w")d8.write(d0)d8.close()e.log("Saved to "..bg.."!")end;f:on("char",function(d9)if m and o then local c0=j[k]if c0=="Save"then local a0=string.byte(d9)if a0>=string.byte("a")and a0<=string.byte("z")or a0>=string.byte("A")and a0<=string.byte("Z")or a0>=string.byte("0")and a0<=string.byte("9")then p=p..d9 end end end end)f:on("key",function(da)if da==keys.leftCtrl then m=not m;o=false elseif m then if o then local c0=j[k]if c0=="Save"then if da==keys.enter then d4(p)m=false;k=1;be()e.audio.playSound("entity.experience_orb.pickup",0.3)elseif da==keys.backspace then p=p:sub(1,-2)end elseif c0=="Load"then if da==keys.enter then aE:remove()local bh=bc[l]aE=f:add(e.model("pumpkins/"..bh..".stab",{skipNormalize=true}):alignBottom(),0,0,0)aK()m=false;k=1;e.audio.playSound("block.chest.open",0.3)elseif da==keys.delete then local bh=bc[l]if bh then local cp="pumpkins/"..bh;if fs.exists(cp..".stab")then fs.delete(cp..".stab")end;if fs.exists(cp..".obj")then fs.delete(cp..".obj")end;if fs.exists(cp..".mtl")then fs.delete(cp..".mtl")end;be()l=math.max(1,math.min(#bc,l))e.audio.playSound("block.anvil.destroy",0.3)end elseif da==keys.up or da==keys.w then l=math.max(1,l-1)elseif da==keys.down or da==keys.s then l=math.min(#bc,l+1)end end else if da==keys.left or da==keys.a then k=math.max(1,k-1)elseif da==keys.right or da==keys.d then k=math.min(#j,k+1)elseif da==keys.enter then local c0=j[k]if c0=="Exit"then os.queueEvent("terminate")elseif c0=="Hide"then n=not n;m=false;k=1 elseif c0=="New"then aE:remove()aE=f:add(S(),0,0,0)aK()m=false;k=1;e.audio.playSound("item.hoe.till",0.3)elseif c0=="Save"then o=true;p=""elseif c0=="Load"then o=true;l=#bc elseif c0=="Showcase"then C=not C;R()m=false;k=1 end end end end end)f:on("mouse_scroll",function(aT)if aT>0 then u=math.min(t,math.max(s,u/0.95))elseif aT<0 then u=math.min(t,math.max(s,u*0.95))end end)e.run()